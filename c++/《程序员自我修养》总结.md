# 《程序员自我修养》总结

> Author：huziang </br>
>
> Date：18-2-5

## 从源文件到可执行文件的过程：

1. 预编译：

   将include中的头文件进行替换，将#define等宏定义进行替换，最后生成.i文件。

2. 编译：

   编译经过词法分析，语法分析，语义分析，生成中间语言，优化中间语言等步骤，生成对应的汇编语言代码，最后生成.s文件。

3. 汇编：

   简单的将汇编码替换成机器码，生成.o。

4. 链接：

   将不同文件连接到一起，填充需要重定位的变量值，最后生成可执行文件。

## 从目标文件到生成可执行文件的过程：

目标文件在linux平台下是ELF格式的文件，在windows平台下是PE/COFF格式。

编译器链接目标文件的过程：

1. 链接器先扫描所有的输入文件，获得输入文件各个段的长度，属性，和位置。从而计算出需要的总位置。
2. 使用之前收集的信息，将段按照姓名合并到一起，比如：所有的.text段合并到一起，所有的.data段合并到一起；并且有些段会被丢掉，比如.comment段。
3. 分析输入文件的重定向段，获得重定向符号解析表，重定向对应段中需要重定向的符号。重定向有两种，一种是相对的，一种是绝对的。相对重定向应用于函数，绝对重定向应用于变量。（取决于move和call指令）
4. 消除重复的段，得到可执行文件。