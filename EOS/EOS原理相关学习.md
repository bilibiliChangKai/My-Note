# EOS原理相关学习

## 拜占庭容错（PBFT算法）：

- 解决问题：区块链间的认证问题，使用拜占庭容错稀疏报头验证整个区块链。

- 实现原理：

  ​	讯息在分散式网络中节点间互相交换后，由各节点列出所有得到的信息，以大多数的结果作为解决办法。而在PBFT算法中，主要依据法定多数的决定，一个节点代表一票，以少数服从多数的方式实现了拜占庭的容错演算。至多容错量以不超过全部节点数的1/3，意即如果有超过2/3的正常节点，整个系统就便可正常运作(R ≥ 3F + 1; R：节点总数，F：有问题节点总数)。

- 运作步骤：

  1. 取一个副本作为主节点，其他的副本作为备份
  2. 用户端向主节点发送使用服务操作的请求
  3. 主节点通过广播将自己收到的请求发送给其他副本
  4. 所有副本执行请求（根据收到的请求，最多数原则），并将结果发回用户端
  5. 用户端需要等待F+1个不同副本节点发回相同的结果（即保证结果正确），作为整个操作的最终结果

- 其他：

  - 口头版：每个节点收到请求后，都需要发送该请求给其他节点，即All to All广播。
  - 签名版：每个节点收到请求后，签署数字签名。主节点统计后再发送一遍给所有节点即可。

## 委托权益证明机制（DPOS）：

- 解决问题：确定谁是块的生产者的问题。与POW不同的是，DPOS采用股份投票的方式决定谁来生产区块，POW采用电脑运算（电脑计算速度）的方式决定谁是下一个生产者。

- 实现原理：

  ​	每个股东都拥有投票权，能投票给证人，证人中，得票多的成为见证人。见证人随机轮流生产区块。生产一轮区块后，重新生成新一轮见证人。

- 运作步骤：

  1. 每个股东都有一票，可以将该票投给自己倾向的证人。
  2. 证人票数最多的N位（EOS中为21位）成为见证人。
  3. 见证人随机轮流生产区块，生产区块可以获得收入，收入由区块中的交易的手续费组成。
  4. 生产一轮区块或过一段时间后，股东重新生成新的见证人。
  5. 在某个时间点，可能会调整区块奖励。

- 其他：

  - 整个过程中股东可以观察见证人所做所为，是否合格。
  - 在EOS中，DPOS也可以生成选定代表，选定代表可以修改系统参数。

## 令牌：

- 解决问题：防止程序滥用资源。

- 实现原理：

  ​	用户持有令牌才能使用资源，持有的令牌越多，可用的资源越多。

  ​	资源分为：带宽和日志存储（磁盘），计算和计算积压（CPU），状态存储（RAM）。

- 运作步骤：

  1. 块生产者发布他们的带宽，计算和状态的可用容量
  2. 用户根据自己拥有的的总代币比例，获得令牌。
  3. 用户根据令牌获得资源。

## EOS工作模型：

- 解决问题：降低EOS延迟

- 实现原理：

  ​	块中有同步机制，可以进行细分。

  如图：

  ```
    Block
  
      Region
  
        Cycles (sequential)
  
          Shards (parallel)
  
            Transactions (sequential)
  
              Actions (sequential)
  
                Receiver and Notified Accounts (parallel)
  ```